# 阿里云服务器配置推荐

## 📊 应用资源需求分析

### 应用特点
- **框架**: Next.js 14 (SSR + API Routes)
- **进程管理**: PM2 集群模式，2个实例
- **内存限制**: 每个实例最大 1GB
- **数据库**: Supabase (外部服务，不占用服务器资源)
- **文件存储**: Supabase Storage (外部服务)
- **并发处理**: API 路由处理图片/视频生成请求

### 当前 Vercel 使用情况（参考）
- Edge Requests (6小时): 2.2K
- Function Invocations (6小时): 1.4K
- 平均每小时: ~367 请求

---

## 💰 推荐配置方案

### 🟢 方案一：入门配置（适合测试/小规模使用）

**配置**:
- **CPU**: 2核
- **内存**: 2GB
- **系统盘**: 40GB SSD
- **带宽**: 3-5Mbps
- **操作系统**: Ubuntu 22.04 LTS

**适用场景**:
- ✅ 个人项目测试
- ✅ 小规模用户（< 100 日活）
- ✅ 预算有限

**价格参考**: 
- 包年: 约 ¥200-300/月
- 按量付费: 约 ¥0.3-0.5/小时

**性能预期**:
- 可同时处理 50-100 并发请求
- 响应时间: 200-500ms
- 适合初期部署和测试

---

### 🟡 方案二：推荐配置（适合中小规模生产环境）⭐

**配置**:
- **CPU**: 2核
- **内存**: 4GB
- **系统盘**: 40GB SSD
- **带宽**: 5-10Mbps
- **操作系统**: Ubuntu 22.04 LTS

**适用场景**:
- ✅ 中小规模生产环境
- ✅ 中等用户量（100-1000 日活）
- ✅ 需要稳定性能

**价格参考**:
- 包年: 约 ¥300-500/月
- 按量付费: 约 ¥0.5-0.8/小时

**性能预期**:
- 可同时处理 200-500 并发请求
- 响应时间: 100-300ms
- **推荐用于生产环境**

**为什么推荐**:
- PM2 配置 2 个实例，每个 1GB，总共需要 2GB+ 系统开销
- 4GB 内存可以稳定运行，留有缓冲
- 性价比最高

---

### 🔴 方案三：高性能配置（适合大规模使用）

**配置**:
- **CPU**: 4核
- **内存**: 8GB
- **系统盘**: 40GB SSD
- **带宽**: 10-20Mbps
- **操作系统**: Ubuntu 22.04 LTS

**适用场景**:
- ✅ 大规模生产环境
- ✅ 高用户量（> 1000 日活）
- ✅ 需要高性能和稳定性

**价格参考**:
- 包年: 约 ¥600-1000/月
- 按量付费: 约 ¥1.0-1.5/小时

**性能预期**:
- 可同时处理 500-1000+ 并发请求
- 响应时间: 50-200ms
- 可以调整 PM2 实例数为 4 个

---

## 📋 详细配置说明

### CPU 选择
- **2核**: 足够运行 Next.js + PM2 集群（2实例）
- **4核**: 可以运行更多 PM2 实例，提升并发能力

### 内存选择
- **2GB**: 最低配置，PM2 2实例（2GB）+ 系统（500MB）= 勉强够用
- **4GB**: 推荐配置，PM2 2实例（2GB）+ 系统（1GB）+ 缓冲（1GB）= 稳定运行
- **8GB**: 高性能配置，可以运行 4 个 PM2 实例

### 存储选择
- **系统盘**: 40GB SSD 足够（Next.js 构建后约 500MB-1GB）
- **数据盘**: 不需要（数据存储在 Supabase）

### 带宽选择
- **3-5Mbps**: 适合小规模（约 50 并发用户）
- **5-10Mbps**: 推荐（约 200 并发用户）
- **10-20Mbps**: 高性能（约 500+ 并发用户）

### 操作系统
- **推荐**: Ubuntu 22.04 LTS
- **备选**: CentOS 7+ / Alibaba Cloud Linux

---

## 💡 成本优化建议

### 1. 选择包年包月（更便宜）
- 包年通常比按量付费便宜 30-50%
- 适合长期使用

### 2. 使用抢占式实例（测试环境）
- 价格便宜 50-80%
- 适合测试，不适合生产

### 3. 选择合适的地域
- 国内用户: 选择华东1（杭州）或华北2（北京）
- 价格差异不大，主要看延迟

### 4. 带宽按需升级
- 初期选择 5Mbps
- 根据实际使用情况升级
- 可以随时调整

---

## 🎯 我的推荐

### 对于您的项目，我推荐：

**🟡 方案二：2核4GB + 5Mbps 带宽**

**理由**:
1. ✅ **内存充足**: PM2 配置 2 个实例，每个 1GB，4GB 内存可以稳定运行
2. ✅ **性价比高**: 价格适中，性能足够
3. ✅ **可扩展**: 后续可以根据需求升级
4. ✅ **稳定可靠**: 适合生产环境

**具体配置**:
```
实例规格: ecs.t6-c2m4.large (或类似规格)
CPU: 2核
内存: 4GB
系统盘: 40GB SSD
带宽: 5Mbps
操作系统: Ubuntu 22.04 LTS
地域: 华东1（杭州）或 华北2（北京）
```

**预计成本**:
- 包年: ¥300-500/月
- 按量付费: ¥0.5-0.8/小时

---

## 📊 配置对比表

| 配置 | CPU | 内存 | 带宽 | 适用场景 | 月成本 |
|------|-----|------|------|----------|--------|
| 入门 | 2核 | 2GB | 3-5Mbps | 测试/小规模 | ¥200-300 |
| **推荐** | **2核** | **4GB** | **5-10Mbps** | **生产环境** | **¥300-500** |
| 高性能 | 4核 | 8GB | 10-20Mbps | 大规模 | ¥600-1000 |

---

## 🔄 后续升级路径

### 如果 2核4GB 不够用，可以：

1. **垂直升级**（推荐）
   - 2核4GB → 4核8GB
   - 无需迁移数据
   - 停机时间短（约 5-10 分钟）

2. **水平扩展**
   - 增加负载均衡
   - 部署多台服务器
   - 需要配置更复杂

3. **优化应用**
   - 启用 CDN 加速静态资源
   - 优化数据库查询
   - 使用 Redis 缓存

---

## ⚠️ 注意事项

### 1. 首次购买建议
- 先选择按量付费测试 1-2 天
- 确认配置合适后再转为包年包月

### 2. 安全组配置
- 开放端口: 22 (SSH), 80 (HTTP), 443 (HTTPS)
- 其他端口不要对外开放

### 3. 地域选择
- 选择离用户最近的地域
- 国内用户推荐: 华东1（杭州）

### 4. 系统盘
- 40GB 足够使用
- 如果担心不够，可以选择 60GB（多 ¥10-20/月）

---

## 📞 购买建议

### 在阿里云控制台购买时：

1. **实例规格**: 选择 `ecs.t6-c2m4.large` 或类似规格
2. **镜像**: 选择 `Ubuntu 22.04 64位`
3. **网络**: 选择 `专有网络 VPC`
4. **公网IP**: 选择 `分配公网IPv4地址`
5. **带宽**: 选择 `按固定带宽`，设置为 `5Mbps`
6. **安全组**: 创建新安全组，开放 22, 80, 443 端口
7. **系统盘**: 选择 `40GB SSD云盘`

### 优惠活动
- 新用户通常有首年优惠
- 关注阿里云官网活动
- 学生用户有学生优惠

---

## ✅ 总结

**推荐配置**: **2核4GB + 5Mbps 带宽 + Ubuntu 22.04**

**预计成本**: **¥300-500/月**（包年）

**这个配置可以**:
- ✅ 稳定运行 Next.js 应用
- ✅ 支持 200-500 并发用户
- ✅ 满足中小规模生产环境需求
- ✅ 后续可以轻松升级

**开始部署后，如果发现配置不够，可以随时升级！**






